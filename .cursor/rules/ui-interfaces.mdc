---
description: CLI ë° ì›¹ ì¸í„°í˜ì´ìŠ¤ ê°œë°œì„ ìœ„í•œ ì‚¬ìš©ì ê²½í—˜ ìµœì í™” ê·œì¹™
globs: "frontend/**/*.py"
alwaysApply: false
---

<rule>
<meta>
<title>CLI and Web Interface Development Standards</title>
<description>ì‚¬ìš©ì ì¹œí™”ì ì¸ CLIì™€ Streamlit ì›¹ ì¸í„°í˜ì´ìŠ¤ ê°œë°œì„ ìœ„í•œ UX/UI ê°€ì´ë“œë¼ì¸</description>
<created-at utc-timestamp="1720684800">2025-07-08, 11:40 AM KST</created-at>
<last-updated-at utc-timestamp="1720684800">2025-07-08, 11:40 AM KST</last-updated-at>
<applies-to>
<file-matcher glob="frontend/**/*.py">í”„ë¡ íŠ¸ì—”ë“œ ê´€ë ¨ íŒŒì¼</file-matcher>
<file-matcher glob="cli.py">CLI ë©”ì¸ íŒŒì¼</file-matcher>
<file-matcher glob="app.py">ì›¹ ì•± ë©”ì¸ íŒŒì¼</file-matcher>
</applies-to>
</meta>

<requirements>
<requirement priority="critical">
<description>Rich Consoleì„ ì‚¬ìš©í•˜ì—¬ CLIì—ì„œ ì•„ë¦„ë‹µê³  ì •ë³´ê°€ í’ë¶€í•œ ì¶œë ¥ì„ ì œê³µí•œë‹¤.</description>
<examples>
<example title="Rich Console í™œìš©">
<correct-example title="í’ë¶€í•œ CLI ì¶œë ¥" conditions="CLI ë©”ì‹œì§€ í‘œì‹œ" expected-result="ì‹œê°ì ìœ¼ë¡œ ë§¤ë ¥ì ì¸ ì¶œë ¥" correctness-criteria="Rich ì»´í¬ë„ŒíŠ¸ í™œìš©"><![CDATA[
from rich.console import Console
from rich.panel import Panel
from rich.progress import Progress, SpinnerColumn, TextColumn, BarColumn, TaskProgressColumn
from rich.table import Table
from rich.syntax import Syntax
from rich.markdown import Markdown
from rich import box
from rich.layout import Layout
from rich.live import Live
import asyncio

class DecepticonCLI:
    """Decepticon CLI ì¸í„°í˜ì´ìŠ¤"""
    
    def __init__(self):
        self.console = Console()
        self.theme = {
            "primary": "cyan",
            "secondary": "blue", 
            "success": "green",
            "warning": "yellow",
            "error": "red",
            "info": "white"
        }
    
    def display_banner(self):
        """Decepticon ì‹œì‘ ë°°ë„ˆ í‘œì‹œ"""
        banner_text = """
# ğŸ¤– DECEPTICON
## Vibe Hacking Agent

*AI-Powered Red Team Testing Framework*
        """
        
        banner_panel = Panel(
            Markdown(banner_text),
            box=box.DOUBLE,
            border_style=self.theme["primary"],
            title="[bold cyan]Welcome to Decepticon[/bold cyan]",
            title_align="center"
        )
        
        self.console.print(banner_panel)
        self.console.print()
    
    def display_agent_status(self, agents_info: Dict[str, Any]):
        """ì—ì´ì „íŠ¸ ìƒíƒœ í…Œì´ë¸” í‘œì‹œ"""
        table = Table(
            title="ğŸ” Agent Status",
            box=box.ROUNDED,
            header_style="bold cyan"
        )
        
        table.add_column("Agent", style="bold white", width=20)
        table.add_column("Status", justify="center", width=12)
        table.add_column("Tools", justify="center", width=8) 
        table.add_column("Last Activity", style="dim", width=20)
        
        for agent_name, info in agents_info.items():
            status_style = self._get_status_style(info.get("status", "unknown"))
            status_icon = self._get_status_icon(info.get("status", "unknown"))
            
            table.add_row(
                f"[{self.theme['primary']}]{agent_name}[/{self.theme['primary']}]",
                f"[{status_style}]{status_icon} {info.get('status', 'Unknown')}[/{status_style}]",
                str(info.get("tool_count", 0)),
                info.get("last_activity", "Never")
            )
        
        self.console.print(table)
        self.console.print()
    
    async def display_operation_progress(self, operation_name: str, tasks: List[str]):
        """ì‹¤ì‹œê°„ ì‘ì—… ì§„í–‰ìƒí™© í‘œì‹œ"""
        with Progress(
            SpinnerColumn(),
            TextColumn("[progress.description]{task.description}"),
            BarColumn(),
            TaskProgressColumn(),
            console=self.console
        ) as progress:
            
            main_task = progress.add_task(
                f"[{self.theme['primary']}]{operation_name}[/{self.theme['primary']}]", 
                total=len(tasks)
            )
            
            for i, task_name in enumerate(tasks):
                sub_task = progress.add_task(f"  â””â”€ {task_name}", total=100)
                
                # ì‘ì—… ì‹œë®¬ë ˆì´ì…˜
                for step in range(100):
                    await asyncio.sleep(0.02)  # ì‹¤ì œ ì‘ì—…ìœ¼ë¡œ ëŒ€ì²´
                    progress.update(sub_task, advance=1)
                
                progress.update(main_task, advance=1)
                progress.remove_task(sub_task)
    
    def display_scan_results(self, scan_results: Dict[str, Any]):
        """ìŠ¤ìº” ê²°ê³¼ í‘œì‹œ"""
        target = scan_results.get("target", "Unknown")
        
        # ê²°ê³¼ í—¤ë”
        header_panel = Panel(
            f"[bold {self.theme['primary']}]Scan Results for {target}[/bold {self.theme['primary']}]",
            box=box.ROUNDED,
            border_style=self.theme["primary"]
        )
        self.console.print(header_panel)
        
        # í¬íŠ¸ ìŠ¤ìº” ê²°ê³¼ í…Œì´ë¸”
        if "ports" in scan_results:
            ports_table = Table(
                title="Open Ports",
                box=box.SIMPLE,
                header_style="bold green"
            )
            ports_table.add_column("Port", justify="center")
            ports_table.add_column("Protocol", justify="center")
            ports_table.add_column("Service", style="cyan")
            ports_table.add_column("Version", style="dim")
            
            for port_info in scan_results["ports"]:
                ports_table.add_row(
                    str(port_info.get("port", "")),
                    port_info.get("protocol", "TCP").upper(),
                    port_info.get("service", "Unknown"),
                    port_info.get("version", "N/A")
                )
            
            self.console.print(ports_table)
        
        # ì·¨ì•½ì  ìš”ì•½
        if "vulnerabilities" in scan_results:
            vulns = scan_results["vulnerabilities"]
            
            vuln_summary = Panel(
                f"[red]Critical: {vulns.get('critical', 0)}[/red] | "
                f"[yellow]High: {vulns.get('high', 0)}[/yellow] | "
                f"[blue]Medium: {vulns.get('medium', 0)}[/blue] | "
                f"[dim]Low: {vulns.get('low', 0)}[/dim]",
                title="[bold red]Vulnerability Summary[/bold red]",
                box=box.SIMPLE
            )
            self.console.print(vuln_summary)
        
        self.console.print()
    
    def display_code_snippet(self, code: str, language: str = "python"):
        """ì½”ë“œ ìŠ¤ë‹ˆí« í•˜ì´ë¼ì´íŒ…"""
        syntax = Syntax(
            code, 
            language, 
            theme="monokai",
            line_numbers=True,
            word_wrap=True
        )
        
        code_panel = Panel(
            syntax,
            title=f"[bold {self.theme['secondary']}]{language.upper()} Code[/bold {self.theme['secondary']}]",
            border_style=self.theme["secondary"]
        )
        
        self.console.print(code_panel)
    
    def display_error_message(self, error_message: str, suggestions: List[str] = None):
        """ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ"""
        error_content = f"[bold red]âŒ Error:[/bold red] {error_message}"
        
        if suggestions:
            error_content += "\n\n[bold yellow]ğŸ’¡ Suggestions:[/bold yellow]"
            for i, suggestion in enumerate(suggestions, 1):
                error_content += f"\n  {i}. {suggestion}"
        
        error_panel = Panel(
            error_content,
            box=box.HEAVY,
            border_style="red",
            title="[bold red]Error[/bold red]"
        )
        
        self.console.print(error_panel)
    
    def display_success_message(self, message: str, details: str = None):
        """ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ"""
        success_content = f"[bold green]âœ… {message}[/bold green]"
        
        if details:
            success_content += f"\n\n[dim]{details}[/dim]"
        
        success_panel = Panel(
            success_content,
            box=box.ROUNDED,
            border_style="green",
            title="[bold green]Success[/bold green]"
        )
        
        self.console.print(success_panel)
    
    def _get_status_style(self, status: str) -> str:
        """ìƒíƒœì— ë”°ë¥¸ ìŠ¤íƒ€ì¼ ë°˜í™˜"""
        status_styles = {
            "active": "green",
            "ready": "cyan", 
            "busy": "yellow",
            "error": "red",
            "inactive": "dim"
        }
        return status_styles.get(status.lower(), "white")
    
    def _get_status_icon(self, status: str) -> str:
        """ìƒíƒœì— ë”°ë¥¸ ì•„ì´ì½˜ ë°˜í™˜"""
        status_icons = {
            "active": "ğŸŸ¢",
            "ready": "ğŸ”µ",
            "busy": "ğŸŸ¡", 
            "error": "ğŸ”´",
            "inactive": "âš«"
        }
        return status_icons.get(status.lower(), "â“")

# CLI ì‚¬ìš© ì˜ˆì‹œ
async def main_cli_interface():
    """ë©”ì¸ CLI ì¸í„°í˜ì´ìŠ¤"""
    cli = DecepticonCLI()
    
    # ë°°ë„ˆ í‘œì‹œ
    cli.display_banner()
    
    # ì—ì´ì „íŠ¸ ìƒíƒœ í‘œì‹œ
    agents_info = {
        "Planner": {"status": "ready", "tool_count": 3, "last_activity": "2025-07-08 11:30"},
        "Reconnaissance": {"status": "active", "tool_count": 8, "last_activity": "2025-07-08 11:35"},
        "Initial Access": {"status": "ready", "tool_count": 5, "last_activity": "2025-07-08 10:45"},
        "Summary": {"status": "inactive", "tool_count": 2, "last_activity": "Never"}
    }
    
    cli.display_agent_status(agents_info)
    
    # ì‘ì—… ì§„í–‰ìƒí™© í‘œì‹œ ì˜ˆì‹œ
    await cli.display_operation_progress(
        "Network Reconnaissance",
        ["Port Scanning", "Service Detection", "Vulnerability Assessment", "Report Generation"]
    )
]]></correct-example>
<incorrect-example title="ê¸°ë³¸ print ì‚¬ìš©" conditions="CLI ë©”ì‹œì§€ í‘œì‹œ" expected-result="ì‹œê°ì ìœ¼ë¡œ ë§¤ë ¥ì ì¸ ì¶œë ¥" incorrectness-criteria="Rich ì»´í¬ë„ŒíŠ¸ ë¯¸ì‚¬ìš©"><![CDATA[
def basic_cli_output():
    """ê¸°ë³¸ì ì¸ CLI ì¶œë ¥ (ê°œì„  í•„ìš”)"""
    print("Decepticon - AI Red Team Testing")
    print("================================")
    print("Agent Status:")
    print("- Planner: Ready")
    print("- Reconnaissance: Active") 
    print("- Initial Access: Ready")
    print("")
    print("Starting operation...")
]]></incorrect-example>
</example>
</examples>
</requirement>

<requirement priority="high">
<description>Streamlit ì›¹ ì¸í„°í˜ì´ìŠ¤ëŠ” ë°˜ì‘í˜•ì´ê³  ì§ê´€ì ì¸ ì‚¬ìš©ì ê²½í—˜ì„ ì œê³µí•œë‹¤.</description>
<examples>
<example title="Streamlit UI ì»´í¬ë„ŒíŠ¸">
<correct-example title="ë°˜ì‘í˜• ì›¹ ì¸í„°í˜ì´ìŠ¤" conditions="ì›¹ UI êµ¬ì„±ìš”ì†Œ ê°œë°œ" expected-result="ì‚¬ìš©ì ì¹œí™”ì  ì¸í„°í˜ì´ìŠ¤" correctness-criteria="Streamlit ì»´í¬ë„ŒíŠ¸ í™œìš©"><![CDATA[
import streamlit as st
from typing import Dict, Any, List, Optional
import plotly.graph_objects as go
import plotly.express as px
import pandas as pd
from datetime import datetime, timedelta

class DecepticonWebUI:
    """Decepticon ì›¹ ì¸í„°í˜ì´ìŠ¤"""
    
    def __init__(self):
        self.setup_page_config()
        self.init_session_state()
    
    def setup_page_config(self):
        """í˜ì´ì§€ ì„¤ì •"""
        st.set_page_config(
            page_title="Decepticon",
            page_icon="ğŸ¤–",
            layout="wide",
            initial_sidebar_state="expanded"
        )
    
    def init_session_state(self):
        """ì„¸ì…˜ ìƒíƒœ ì´ˆê¸°í™”"""
        if "messages" not in st.session_state:
            st.session_state.messages = []
        if "current_operation" not in st.session_state:
            st.session_state.current_operation = None
        if "scan_results" not in st.session_state:
            st.session_state.scan_results = {}
    
    def render_header(self):
        """í—¤ë” ë Œë”ë§"""
        col1, col2, col3 = st.columns([2, 6, 2])
        
        with col1:
            st.image("assets/logo.png", width=80)
        
        with col2:
            st.title("ğŸ¤– Decepticon")
            st.caption("AI-Powered Red Team Testing Framework")
        
        with col3:
            # ìƒíƒœ í‘œì‹œê¸°
            if st.session_state.current_operation:
                st.success("ğŸŸ¢ Active")
            else:
                st.info("ğŸ”µ Ready")
    
    def render_sidebar(self):
        """ì‚¬ì´ë“œë°” ë Œë”ë§"""
        with st.sidebar:
            st.header("ğŸ¯ Mission Control")
            
            # ì—ì´ì „íŠ¸ ì„ íƒ
            selected_agent = st.selectbox(
                "Select Agent",
                ["Planner", "Reconnaissance", "Initial Access", "Summary"],
                help="Choose which agent to interact with"
            )
            
            # íƒ€ê²Ÿ ì„¤ì •
            target_input = st.text_input(
                "Target",
                placeholder="192.168.1.1 or example.com",
                help="Enter IP address or domain name"
            )
            
            # ìŠ¤ìº” ì˜µì…˜
            st.subheader("ğŸ”§ Scan Options")
            
            scan_type = st.radio(
                "Scan Type",
                ["Quick Scan", "Full Scan", "Stealth Scan"],
                help="Select scanning intensity"
            )
            
            port_range = st.text_input(
                "Port Range",
                value="1-1000",
                help="e.g., 1-1000, 80,443,8080"
            )
            
            # ê³ ê¸‰ ì˜µì…˜
            with st.expander("ğŸ”§ Advanced Options"):
                timeout = st.slider("Timeout (seconds)", 1, 60, 30)
                threads = st.slider("Concurrent Threads", 1, 20, 5)
                stealth_mode = st.checkbox("Stealth Mode")
            
            # ì‹¤í–‰ ë²„íŠ¼
            if st.button("ğŸš€ Start Operation", type="primary", use_container_width=True):
                if target_input:
                    self.start_operation(selected_agent, target_input, {
                        "scan_type": scan_type,
                        "port_range": port_range,
                        "timeout": timeout,
                        "threads": threads,
                        "stealth_mode": stealth_mode
                    })
                else:
                    st.error("Please enter a target")
            
            # ì¤‘ì§€ ë²„íŠ¼
            if st.session_state.current_operation:
                if st.button("â¹ï¸ Stop Operation", type="secondary", use_container_width=True):
                    self.stop_operation()
    
    def render_main_content(self):
        """ë©”ì¸ ì½˜í…ì¸  ë Œë”ë§"""
        # íƒ­ êµ¬ì„±
        tab1, tab2, tab3, tab4 = st.tabs(["ğŸ’¬ Chat", "ğŸ“Š Results", "ğŸ“ˆ Analytics", "âš™ï¸ Settings"])
        
        with tab1:
            self.render_chat_interface()
        
        with tab2:
            self.render_results_dashboard()
        
        with tab3:
            self.render_analytics_dashboard()
        
        with tab4:
            self.render_settings_panel()
    
    def render_chat_interface(self):
        """ì±„íŒ… ì¸í„°í˜ì´ìŠ¤ ë Œë”ë§"""
        # ë©”ì‹œì§€ í‘œì‹œ ì˜ì—­
        chat_container = st.container()
        with chat_container:
            for message in st.session_state.messages:
                with st.chat_message(message["role"]):
                    if message["role"] == "assistant":
                        # ì—ì´ì „íŠ¸ ì‘ë‹µì— ë©”íƒ€ë°ì´í„° í‘œì‹œ
                        col1, col2 = st.columns([3, 1])
                        with col1:
                            st.markdown(message["content"])
                        with col2:
                            if "agent" in message:
                                st.caption(f"ğŸ¤– {message['agent']}")
                            if "timestamp" in message:
                                st.caption(f"â° {message['timestamp']}")
                    else:
                        st.markdown(message["content"])
        
        # ë©”ì‹œì§€ ì…ë ¥
        if prompt := st.chat_input("Enter your command or question..."):
            self.handle_user_input(prompt)
    
    def render_results_dashboard(self):
        """ê²°ê³¼ ëŒ€ì‹œë³´ë“œ ë Œë”ë§"""
        if not st.session_state.scan_results:
            st.info("ğŸ“ No scan results yet. Start an operation to see results here.")
            return
        
        results = st.session_state.scan_results
        
        # ê²°ê³¼ ìš”ì•½ ì¹´ë“œ
        col1, col2, col3, col4 = st.columns(4)
        
        with col1:
            st.metric(
                "Targets Scanned",
                value=results.get("targets_count", 0),
                delta=f"+{results.get('new_targets', 0)}"
            )
        
        with col2:
            st.metric(
                "Open Ports",
                value=results.get("open_ports", 0),
                delta=f"+{results.get('new_ports', 0)}"
            )
        
        with col3:
            st.metric(
                "Vulnerabilities",
                value=results.get("vulnerabilities", 0),
                delta=f"+{results.get('new_vulns', 0)}"
            )
        
        with col4:
            st.metric(
                "Risk Score",
                value=f"{results.get('risk_score', 0):.1f}",
                delta=f"{results.get('risk_change', 0):+.1f}"
            )
        
        # ìƒì„¸ ê²°ê³¼ í…Œì´ë¸”
        if "detailed_results" in results:
            st.subheader("ğŸ“‹ Detailed Results")
            
            df = pd.DataFrame(results["detailed_results"])
            
            # í•„í„°ë§ ì˜µì…˜
            col1, col2 = st.columns(2)
            with col1:
                severity_filter = st.multiselect(
                    "Filter by Severity",
                    options=["Critical", "High", "Medium", "Low"],
                    default=["Critical", "High"]
                )
            
            with col2:
                service_filter = st.multiselect(
                    "Filter by Service",
                    options=df["service"].unique() if "service" in df.columns else []
                )
            
            # í•„í„°ë§ëœ ë°ì´í„° í‘œì‹œ
            filtered_df = df
            if severity_filter and "severity" in df.columns:
                filtered_df = filtered_df[filtered_df["severity"].isin(severity_filter)]
            if service_filter and "service" in df.columns:
                filtered_df = filtered_df[filtered_df["service"].isin(service_filter)]
            
            st.dataframe(
                filtered_df,
                use_container_width=True,
                hide_index=True
            )
    
    def render_analytics_dashboard(self):
        """ë¶„ì„ ëŒ€ì‹œë³´ë“œ ë Œë”ë§"""
        st.subheader("ğŸ“ˆ Security Analytics")
        
        # ê°€ìƒì˜ ë¶„ì„ ë°ì´í„° ìƒì„± (ì‹¤ì œë¡œëŠ” ì‹¤ì œ ë°ì´í„° ì‚¬ìš©)
        dates = pd.date_range(start=datetime.now()-timedelta(days=30), end=datetime.now(), freq='D')
        vulnerability_data = {
            'Date': dates,
            'Critical': np.random.randint(0, 5, len(dates)),
            'High': np.random.randint(5, 15, len(dates)),
            'Medium': np.random.randint(10, 25, len(dates)),
            'Low': np.random.randint(15, 35, len(dates))
        }
        
        df = pd.DataFrame(vulnerability_data)
        
        # ì·¨ì•½ì  íŠ¸ë Œë“œ ì°¨íŠ¸
        fig = go.Figure()
        
        for severity in ['Critical', 'High', 'Medium', 'Low']:
            fig.add_trace(go.Scatter(
                x=df['Date'],
                y=df[severity],
                mode='lines+markers',
                name=severity,
                line=dict(width=2)
            ))
        
        fig.update_layout(
            title="Vulnerability Trends (Last 30 Days)",
            xaxis_title="Date",
            yaxis_title="Count",
            hovermode='x unified'
        )
        
        st.plotly_chart(fig, use_container_width=True)
        
        # í¬íŠ¸ ë¶„í¬ ì°¨íŠ¸
        col1, col2 = st.columns(2)
        
        with col1:
            # í¬íŠ¸ ë¶„í¬ íŒŒì´ ì°¨íŠ¸
            port_data = {'SSH': 15, 'HTTP': 25, 'HTTPS': 20, 'FTP': 8, 'Others': 32}
            
            fig_pie = px.pie(
                values=list(port_data.values()),
                names=list(port_data.keys()),
                title="Service Distribution"
            )
            
            st.plotly_chart(fig_pie, use_container_width=True)
        
        with col2:
            # ìœ„í—˜ë„ ë¶„í¬ ë°” ì°¨íŠ¸
            risk_data = {'Low': 45, 'Medium': 30, 'High': 20, 'Critical': 5}
            
            fig_bar = px.bar(
                x=list(risk_data.keys()),
                y=list(risk_data.values()),
                title="Risk Level Distribution",
                color=list(risk_data.keys()),
                color_discrete_map={
                    'Low': 'green',
                    'Medium': 'yellow', 
                    'High': 'orange',
                    'Critical': 'red'
                }
            )
            
            st.plotly_chart(fig_bar, use_container_width=True)
    
    def render_settings_panel(self):
        """ì„¤ì • íŒ¨ë„ ë Œë”ë§"""
        st.subheader("âš™ï¸ Configuration")
        
        # LLM ì„¤ì •
        with st.expander("ğŸ§  AI Model Settings", expanded=True):
            llm_provider = st.selectbox(
                "LLM Provider",
                ["OpenAI", "Anthropic", "Groq", "Local (Ollama)"]
            )
            
            model_map = {
                "OpenAI": ["gpt-4o", "gpt-4", "gpt-3.5-turbo"],
                "Anthropic": ["claude-3-5-sonnet", "claude-3-opus", "claude-3-haiku"],
                "Groq": ["llama3-70b", "mixtral-8x7b"],
                "Local (Ollama)": ["llama3", "codellama", "mistral"]
            }
            
            selected_model = st.selectbox(
                "Model",
                model_map.get(llm_provider, [])
            )
            
            temperature = st.slider("Temperature", 0.0, 1.0, 0.0, 0.1)
        
        # ë³´ì•ˆ ì„¤ì •
        with st.expander("ğŸ”’ Security Settings"):
            auto_approve = st.checkbox("Auto-approve low-risk operations")
            
            allowed_networks = st.text_area(
                "Allowed Networks",
                value="192.168.0.0/16\n10.0.0.0/8\n172.16.0.0/12",
                help="One network per line"
            )
            
            max_concurrent = st.number_input("Max Concurrent Operations", 1, 10, 3)
        
        # ë¡œê¹… ì„¤ì •
        with st.expander("ğŸ“ Logging Settings"):
            log_level = st.selectbox(
                "Log Level",
                ["DEBUG", "INFO", "WARNING", "ERROR"]
            )
            
            save_conversations = st.checkbox("Save Conversation History", value=True)
            
            export_format = st.selectbox(
                "Export Format",
                ["JSON", "CSV", "PDF"]
            )
        
        # ì„¤ì • ì €ì¥ ë²„íŠ¼
        if st.button("ğŸ’¾ Save Settings", type="primary"):
            self.save_settings({
                "llm_provider": llm_provider,
                "model": selected_model,
                "temperature": temperature,
                "auto_approve": auto_approve,
                "allowed_networks": allowed_networks,
                "max_concurrent": max_concurrent,
                "log_level": log_level,
                "save_conversations": save_conversations,
                "export_format": export_format
            })
    
    def start_operation(self, agent: str, target: str, options: Dict[str, Any]):
        """ì‘ì—… ì‹œì‘"""
        st.session_state.current_operation = {
            "agent": agent,
            "target": target,
            "options": options,
            "start_time": datetime.now()
        }
        
        st.success(f"Started {agent} operation on {target}")
        st.rerun()
    
    def stop_operation(self):
        """ì‘ì—… ì¤‘ì§€"""
        st.session_state.current_operation = None
        st.info("Operation stopped")
        st.rerun()
    
    def handle_user_input(self, prompt: str):
        """ì‚¬ìš©ì ì…ë ¥ ì²˜ë¦¬"""
        # ì‚¬ìš©ì ë©”ì‹œì§€ ì¶”ê°€
        st.session_state.messages.append({
            "role": "user",
            "content": prompt,
            "timestamp": datetime.now().strftime("%H:%M:%S")
        })
        
        # ì—ì´ì „íŠ¸ ì‘ë‹µ ì‹œë®¬ë ˆì´ì…˜ (ì‹¤ì œë¡œëŠ” ì—ì´ì „íŠ¸ í˜¸ì¶œ)
        response = f"Processing your request: {prompt}"
        
        st.session_state.messages.append({
            "role": "assistant",
            "content": response,
            "agent": "Planner",
            "timestamp": datetime.now().strftime("%H:%M:%S")
        })
        
        st.rerun()

# ë©”ì¸ ì›¹ ì•± ì‹¤í–‰
def main_web_app():
    """ë©”ì¸ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜"""
    ui = DecepticonWebUI()
    
    ui.render_header()
    ui.render_sidebar()
    ui.render_main_content()

if __name__ == "__main__":
    main_web_app()
]]></correct-example>
<incorrect-example title="ê¸°ë³¸ Streamlit ì‚¬ìš©" conditions="ì›¹ UI êµ¬ì„±ìš”ì†Œ ê°œë°œ" expected-result="ì‚¬ìš©ì ì¹œí™”ì  ì¸í„°í˜ì´ìŠ¤" incorrectness-criteria="ê¸°ë³¸ì ì¸ ì»´í¬ë„ŒíŠ¸ë§Œ ì‚¬ìš©"><![CDATA[
import streamlit as st

def basic_web_app():
    """ê¸°ë³¸ì ì¸ ì›¹ ì•± (ê°œì„  í•„ìš”)"""
    st.title("Decepticon")
    
    target = st.text_input("Target")
    if st.button("Scan"):
        st.write(f"Scanning {target}...")
    
    st.write("Results will appear here")
]]></incorrect-example>
</example>
</examples>
</requirement>

<requirement priority="high">
<description>ì‹¤ì‹œê°„ í”¼ë“œë°±ê³¼ ì§„í–‰ìƒí™© í‘œì‹œë¥¼ í†µí•´ ì‚¬ìš©ì ê²½í—˜ì„ í–¥ìƒì‹œí‚¨ë‹¤.</description>
<examples>
<example title="ì‹¤ì‹œê°„ UI ì—…ë°ì´íŠ¸">
<correct-example title="ë™ì  ì§„í–‰ìƒí™© í‘œì‹œ" conditions="ì¥ì‹œê°„ ì‘ì—… ì§„í–‰" expected-result="ì‹¤ì‹œê°„ í”¼ë“œë°±" correctness-criteria="ì§„í–‰ë¥ ê³¼ ìƒíƒœ ì—…ë°ì´íŠ¸"><![CDATA[
import streamlit as st
import asyncio
import time
from typing import AsyncGenerator, Dict, Any

class RealTimeUI:
    """ì‹¤ì‹œê°„ UI ì—…ë°ì´íŠ¸ ê´€ë¦¬ì"""
    
    def __init__(self):
        self.progress_placeholder = None
        self.status_placeholder = None
        self.results_placeholder = None
    
    def setup_progress_display(self):
        """ì§„í–‰ìƒí™© í‘œì‹œ ì˜ì—­ ì„¤ì •"""
        self.progress_placeholder = st.empty()
        self.status_placeholder = st.empty()
        self.results_placeholder = st.empty()
    
    async def run_operation_with_progress(
        self, 
        operation_func: callable, 
        operation_name: str,
        **kwargs
    ) -> Dict[str, Any]:
        """ì§„í–‰ìƒí™©ê³¼ í•¨ê»˜ ì‘ì—… ì‹¤í–‰"""
        
        # ì§„í–‰ìƒí™© í‘œì‹œ ì„¤ì •
        self.setup_progress_display()
        
        # ì „ì²´ ì§„í–‰ë¥  ë°”
        progress_bar = self.progress_placeholder.progress(0)
        status_text = self.status_placeholder.empty()
        
        try:
            # ì‘ì—… ì‹¤í–‰ ë° ì§„í–‰ìƒí™© ì—…ë°ì´íŠ¸
            async for progress_data in operation_func(**kwargs):
                # ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
                if "progress" in progress_data:
                    progress_bar.progress(progress_data["progress"] / 100)
                
                # ìƒíƒœ ë©”ì‹œì§€ ì—…ë°ì´íŠ¸
                if "status" in progress_data:
                    status_text.info(f"ğŸ”„ {progress_data['status']}")
                
                # ì¤‘ê°„ ê²°ê³¼ í‘œì‹œ
                if "partial_result" in progress_data:
                    self.display_partial_result(progress_data["partial_result"])
                
                # UI ì—…ë°ì´íŠ¸ë¥¼ ìœ„í•œ ì§§ì€ ëŒ€ê¸°
                await asyncio.sleep(0.1)
            
            # ì™„ë£Œ í‘œì‹œ
            progress_bar.progress(100)
            status_text.success("âœ… Operation completed successfully!")
            
            return {"status": "completed", "message": "Operation finished"}
        
        except Exception as e:
            status_text.error(f"âŒ Operation failed: {str(e)}")
            return {"status": "failed", "error": str(e)}
    
    def display_partial_result(self, result: Dict[str, Any]):
        """ë¶€ë¶„ ê²°ê³¼ í‘œì‹œ"""
        with self.results_placeholder.container():
            if "new_port" in result:
                st.success(f"ğŸ” Found open port: {result['new_port']}")
            
            if "vulnerability" in result:
                vuln = result["vulnerability"]
                severity_colors = {
                    "critical": "ğŸ”´",
                    "high": "ğŸŸ ", 
                    "medium": "ğŸŸ¡",
                    "low": "ğŸŸ¢"
                }
                
                severity = vuln.get("severity", "unknown").lower()
                icon = severity_colors.get(severity, "ğŸ”µ")
                
                st.warning(f"{icon} Vulnerability found: {vuln.get('name', 'Unknown')}")
            
            if "service" in result:
                st.info(f"ğŸ”§ Service detected: {result['service']}")

class StreamingChat:
    """ìŠ¤íŠ¸ë¦¬ë° ì±„íŒ… ì¸í„°í˜ì´ìŠ¤"""
    
    def __init__(self):
        self.message_placeholder = None
    
    async def stream_agent_response(self, agent_func: callable, user_message: str):
        """ì—ì´ì „íŠ¸ ì‘ë‹µ ìŠ¤íŠ¸ë¦¬ë°"""
        
        # ë©”ì‹œì§€ í”Œë ˆì´ìŠ¤í™€ë” ìƒì„±
        self.message_placeholder = st.empty()
        
        # íƒ€ì´í•‘ ì¸ë””ì¼€ì´í„° í‘œì‹œ
        with self.message_placeholder.container():
            with st.chat_message("assistant"):
                typing_placeholder = st.empty()
                
                # íƒ€ì´í•‘ ì• ë‹ˆë©”ì´ì…˜
                for i in range(3):
                    typing_placeholder.markdown("ğŸ¤– Thinking" + "." * (i + 1))
                    await asyncio.sleep(0.5)
        
        # ì‹¤ì œ ì‘ë‹µ ìŠ¤íŠ¸ë¦¬ë°
        response_text = ""
        
        async for chunk in agent_func(user_message):
            response_text += chunk.get("text", "")
            
            # ì‹¤ì‹œê°„ìœ¼ë¡œ ì‘ë‹µ ì—…ë°ì´íŠ¸
            with self.message_placeholder.container():
                with st.chat_message("assistant"):
                    st.markdown(response_text + "â–Œ")  # ì»¤ì„œ í‘œì‹œ
            
            await asyncio.sleep(0.05)  # íƒ€ì´í•‘ íš¨ê³¼
        
        # ìµœì¢… ì‘ë‹µ í‘œì‹œ (ì»¤ì„œ ì œê±°)
        with self.message_placeholder.container():
            with st.chat_message("assistant"):
                st.markdown(response_text)
                
                # ë©”íƒ€ë°ì´í„° í‘œì‹œ
                col1, col2 = st.columns([3, 1])
                with col2:
                    st.caption(f"ğŸ¤– {chunk.get('agent', 'Unknown')}")
                    st.caption(f"â° {datetime.now().strftime('%H:%M:%S')}")

# ì‹¤ì‹œê°„ ìŠ¤ìº” ì‹œë®¬ë ˆì´ì…˜
async def simulate_network_scan(target: str) -> AsyncGenerator[Dict[str, Any], None]:
    """ë„¤íŠ¸ì›Œí¬ ìŠ¤ìº” ì‹œë®¬ë ˆì´ì…˜"""
    
    ports_to_scan = [22, 23, 25, 53, 80, 110, 143, 443, 993, 995]
    total_ports = len(ports_to_scan)
    
    yield {"status": f"Starting scan on {target}", "progress": 0}
    await asyncio.sleep(1)
    
    for i, port in enumerate(ports_to_scan):
        # í¬íŠ¸ ìŠ¤ìº” ì‹œë®¬ë ˆì´ì…˜
        yield {"status": f"Scanning port {port}", "progress": (i * 100) // total_ports}
        await asyncio.sleep(0.5)
        
        # ëœë¤í•˜ê²Œ ì—´ë¦° í¬íŠ¸ ë°œê²¬
        if port in [22, 80, 443]:
            yield {
                "partial_result": {"new_port": port},
                "progress": (i * 100) // total_ports
            }
            
            # ì„œë¹„ìŠ¤ ê°ì§€
            services = {22: "SSH", 80: "HTTP", 443: "HTTPS"}
            yield {
                "partial_result": {"service": services[port]},
                "progress": (i * 100) // total_ports
            }
        
        # ì·¨ì•½ì  ë°œê²¬ ì‹œë®¬ë ˆì´ì…˜
        if port == 22:
            yield {
                "partial_result": {
                    "vulnerability": {
                        "name": "Weak SSH Configuration",
                        "severity": "medium"
                    }
                },
                "progress": (i * 100) // total_ports
            }
    
    yield {"status": "Scan completed", "progress": 100}

# ì‹¤ì‹œê°„ ì—ì´ì „íŠ¸ ì‘ë‹µ ì‹œë®¬ë ˆì´ì…˜
async def simulate_agent_response(user_message: str) -> AsyncGenerator[Dict[str, Any], None]:
    """ì—ì´ì „íŠ¸ ì‘ë‹µ ì‹œë®¬ë ˆì´ì…˜"""
    
    response_parts = [
        "I understand you want to ",
        f"perform '{user_message}'. ",
        "Let me analyze the request and ",
        "provide you with the best approach. ",
        "\n\nBased on my analysis, ",
        "I recommend starting with ",
        "reconnaissance to gather ",
        "information about the target. ",
        "\n\nWould you like me to ",
        "proceed with this plan?"
    ]
    
    for part in response_parts:
        yield {"text": part, "agent": "Planner"}
        await asyncio.sleep(0.1)

# ì‚¬ìš© ì˜ˆì‹œ
async def demo_real_time_interface():
    """ì‹¤ì‹œê°„ ì¸í„°í˜ì´ìŠ¤ ë°ëª¨"""
    st.header("ğŸ”„ Real-Time Operations")
    
    # ì‹¤ì‹œê°„ ìŠ¤ìº” ë°ëª¨
    if st.button("Start Network Scan"):
        ui = RealTimeUI()
        await ui.run_operation_with_progress(
            simulate_network_scan,
            "Network Scan",
            target="192.168.1.1"
        )
    
    # ìŠ¤íŠ¸ë¦¬ë° ì±„íŒ… ë°ëª¨
    if prompt := st.chat_input("Ask the AI agent..."):
        chat = StreamingChat()
        await chat.stream_agent_response(simulate_agent_response, prompt)
]]></correct-example>
<incorrect-example title="ì •ì  ì—…ë°ì´íŠ¸" conditions="ì¥ì‹œê°„ ì‘ì—… ì§„í–‰" expected-result="ì‹¤ì‹œê°„ í”¼ë“œë°±" incorrectness-criteria="ì§„í–‰ìƒí™© í‘œì‹œ ì—†ìŒ"><![CDATA[
def static_operation():
    """ì •ì  ì‘ì—… ì‹¤í–‰ (ê°œì„  í•„ìš”)"""
    if st.button("Start Scan"):
        st.write("Scanning...")
        # ì¥ì‹œê°„ ì‘ì—… ìˆ˜í–‰ (ì§„í–‰ìƒí™© í‘œì‹œ ì—†ìŒ)
        time.sleep(10)
        st.write("Scan completed")
]]></incorrect-example>
</example>
</examples>
</requirement>

<non-negotiable priority="critical">
<description>ë³´ì•ˆ ê´€ë ¨ ì‘ì—…ì€ ì‚¬ìš©ì í™•ì¸ ì—†ì´ ìë™ ì‹¤í–‰ë˜ì§€ ì•Šë„ë¡ ë³´í˜¸í•œë‹¤.</description>
<examples>
<example title="ë³´ì•ˆ ì‘ì—… ìŠ¹ì¸ UI">
<correct-example title="ì‚¬ìš©ì ìŠ¹ì¸ ì¸í„°í˜ì´ìŠ¤" conditions="ìœ„í—˜í•œ ë³´ì•ˆ ì‘ì—… ì‹¤í–‰" expected-result="ëª…ì‹œì  ì‚¬ìš©ì ìŠ¹ì¸" correctness-criteria="ìŠ¹ì¸ ë‹¤ì´ì–¼ë¡œê·¸ì™€ ê²½ê³  ë©”ì‹œì§€"><![CDATA[
import streamlit as st
from typing import Dict, Any, Optional
from enum import Enum

class RiskLevel(Enum):
    LOW = "low"
    MEDIUM = "medium" 
    HIGH = "high"
    CRITICAL = "critical"

class SecurityApprovalUI:
    """ë³´ì•ˆ ì‘ì—… ìŠ¹ì¸ UI"""
    
    def __init__(self):
        self.risk_colors = {
            RiskLevel.LOW: "green",
            RiskLevel.MEDIUM: "blue", 
            RiskLevel.HIGH: "orange",
            RiskLevel.CRITICAL: "red"
        }
        
        self.risk_icons = {
            RiskLevel.LOW: "ğŸŸ¢",
            RiskLevel.MEDIUM: "ğŸ”µ",
            RiskLevel.HIGH: "ğŸŸ ", 
            RiskLevel.CRITICAL: "ğŸ”´"
        }
    
    def show_approval_dialog(
        self,
        operation: str,
        target: str,
        risk_level: RiskLevel,
        details: Dict[str, Any],
        warnings: Optional[List[str]] = None
    ) -> bool:
        """ë³´ì•ˆ ì‘ì—… ìŠ¹ì¸ ë‹¤ì´ì–¼ë¡œê·¸ í‘œì‹œ"""
        
        # ìœ„í—˜ë„ì— ë”°ë¥¸ ìŠ¤íƒ€ì¼ë§
        color = self.risk_colors[risk_level]
        icon = self.risk_icons[risk_level]
        
        # ìŠ¹ì¸ ë‹¤ì´ì–¼ë¡œê·¸
        with st.container():
            # ê²½ê³  í—¤ë”
            st.markdown(f"""
            <div style="
                border: 3px solid {color}; 
                border-radius: 10px; 
                padding: 20px; 
                background-color: rgba(255,255,255,0.05);
                margin: 20px 0;
            ">
            """, unsafe_allow_html=True)
            
            # ìœ„í—˜ë„ í‘œì‹œ
            st.markdown(f"### {icon} Security Operation Approval Required")
            st.markdown(f"**Risk Level: {risk_level.value.upper()}**")
            
            # ì‘ì—… ì •ë³´
            col1, col2 = st.columns(2)
            with col1:
                st.markdown(f"**Operation:** {operation}")
                st.markdown(f"**Target:** {target}")
            
            with col2:
                st.markdown(f"**Date:** {datetime.now().strftime('%Y-%m-%d %H:%M')}")
                st.markdown(f"**User:** {st.session_state.get('user_id', 'Unknown')}")
            
            # ì‘ì—… ì„¸ë¶€ì‚¬í•­
            if details:
                st.markdown("**Operation Details:**")
                for key, value in details.items():
                    st.markdown(f"- **{key}:** {value}")
            
            # ê²½ê³  ë©”ì‹œì§€
            if warnings:
                st.markdown("**âš ï¸ Warnings:**")
                for warning in warnings:
                    st.warning(warning)
            
            # ìœ„í—˜ë„ë³„ ì¶”ê°€ ê²½ê³ 
            if risk_level == RiskLevel.CRITICAL:
                st.error("""
                ğŸš¨ **CRITICAL RISK OPERATION** ğŸš¨
                
                This operation may cause:
                - System damage or data loss
                - Service disruption
                - Security policy violations
                
                Ensure you have proper authorization and backups.
                """)
            
            elif risk_level == RiskLevel.HIGH:
                st.warning("""
                âš ï¸ **HIGH RISK OPERATION**
                
                This operation may:
                - Modify system configurations
                - Access sensitive data
                - Trigger security alerts
                
                Verify target authorization before proceeding.
                """)
            
            # ìŠ¹ì¸ ì²´í¬ë°•ìŠ¤
            st.markdown("---")
            
            # í•„ìˆ˜ í™•ì¸ ì‚¬í•­
            confirmations = []
            
            confirmations.append(st.checkbox(
                "âœ… I confirm that I have authorization to perform this operation on the specified target",
                key=f"auth_confirm_{operation}"
            ))
            
            confirmations.append(st.checkbox(
                "âœ… I understand the risks and potential consequences of this operation",
                key=f"risk_confirm_{operation}"
            ))
            
            if risk_level in [RiskLevel.HIGH, RiskLevel.CRITICAL]:
                confirmations.append(st.checkbox(
                    "âœ… I have reviewed security policies and obtained necessary approvals",
                    key=f"policy_confirm_{operation}"
                ))
            
            if risk_level == RiskLevel.CRITICAL:
                confirmations.append(st.checkbox(
                    "âœ… I have created appropriate backups and tested recovery procedures",
                    key=f"backup_confirm_{operation}"
                ))
            
            # ëª¨ë“  í™•ì¸ì‚¬í•­ì´ ì²´í¬ë˜ì—ˆëŠ”ì§€ ê²€ì¦
            all_confirmed = all(confirmations)
            
            # ìŠ¹ì¸/ê±°ë¶€ ë²„íŠ¼
            col1, col2, col3 = st.columns([1, 1, 1])
            
            with col1:
                if st.button(
                    "âŒ Cancel Operation",
                    type="secondary",
                    use_container_width=True,
                    key=f"cancel_{operation}"
                ):
                    st.session_state[f"approval_{operation}"] = False
                    st.error("Operation cancelled by user")
                    return False
            
            with col2:
                # ì¶”ê°€ ì •ë³´ ë²„íŠ¼
                if st.button(
                    "â„¹ï¸ More Info",
                    use_container_width=True,
                    key=f"info_{operation}"
                ):
                    self.show_operation_details(operation, target, details)
            
            with col3:
                approve_button = st.button(
                    "âœ… Approve & Execute",
                    type="primary",
                    disabled=not all_confirmed,
                    use_container_width=True,
                    key=f"approve_{operation}"
                )
                
                if approve_button and all_confirmed:
                    # ìµœì¢… í™•ì¸
                    if self.final_confirmation_dialog(operation, risk_level):
                        st.session_state[f"approval_{operation}"] = True
                        st.success("Operation approved and queued for execution")
                        return True
            
            st.markdown("</div>", unsafe_allow_html=True)
        
        return False
    
    def final_confirmation_dialog(self, operation: str, risk_level: RiskLevel) -> bool:
        """ìµœì¢… í™•ì¸ ë‹¤ì´ì–¼ë¡œê·¸"""
        if risk_level in [RiskLevel.HIGH, RiskLevel.CRITICAL]:
            
            # ìµœì¢… í™•ì¸ ëª¨ë‹¬ ì‹œë®¬ë ˆì´ì…˜
            st.markdown("### ğŸ” Final Confirmation")
            
            confirmation_text = st.text_input(
                f"Type 'EXECUTE {operation.upper()}' to confirm:",
                key=f"final_confirm_{operation}",
                help="This is a final safety check for high-risk operations"
            )
            
            expected_text = f"EXECUTE {operation.upper()}"
            
            if confirmation_text == expected_text:
                return True
            elif confirmation_text:
                st.error("Confirmation text does not match. Please type exactly as shown.")
                return False
        
        return True
    
    def show_operation_details(self, operation: str, target: str, details: Dict[str, Any]):
        """ì‘ì—… ì„¸ë¶€ì •ë³´ í‘œì‹œ"""
        with st.expander("ğŸ“‹ Detailed Operation Information", expanded=True):
            
            # ì‘ì—… ì„¤ëª…
            operation_descriptions = {
                "network_scan": "Performs network reconnaissance to identify open ports and services",
                "vulnerability_scan": "Scans for known vulnerabilities and security weaknesses",
                "exploit_attempt": "Attempts to exploit identified vulnerabilities",
                "privilege_escalation": "Attempts to gain higher privileges on the target system"
            }
            
            description = operation_descriptions.get(
                operation.lower().replace(" ", "_"),
                "Custom security operation"
            )
            
            st.markdown(f"**Description:** {description}")
            
            # ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­
            st.markdown("**Technical Details:**")
            st.json(details)
            
            # ì˜ˆìƒ ì‹¤í–‰ ì‹œê°„
            estimated_times = {
                "network_scan": "5-15 minutes",
                "vulnerability_scan": "15-60 minutes", 
                "exploit_attempt": "1-10 minutes",
                "privilege_escalation": "5-30 minutes"
            }
            
            estimated_time = estimated_times.get(
                operation.lower().replace(" ", "_"),
                "Variable"
            )
            
            st.markdown(f"**Estimated Duration:** {estimated_time}")
    
    def show_security_settings(self):
        """ë³´ì•ˆ ì„¤ì • í‘œì‹œ"""
        with st.sidebar:
            st.markdown("### ğŸ”’ Security Settings")
            
            # ìë™ ìŠ¹ì¸ ì„¤ì •
            auto_approve_low = st.checkbox(
                "Auto-approve LOW risk operations",
                value=st.session_state.get("auto_approve_low", False),
                help="Automatically approve operations with low security risk"
            )
            
            # ì•Œë¦¼ ì„¤ì •
            email_notifications = st.checkbox(
                "Email notifications for HIGH/CRITICAL operations",
                value=st.session_state.get("email_notifications", True)
            )
            
            # ìŠ¹ì¸ ì‹œê°„ ì œí•œ
            approval_timeout = st.slider(
                "Approval timeout (minutes)",
                1, 60, 15,
                help="How long to wait for user approval before cancelling"
            )
            
            # ì„¸ì…˜ì— ì €ì¥
            st.session_state.update({
                "auto_approve_low": auto_approve_low,
                "email_notifications": email_notifications,
                "approval_timeout": approval_timeout
            })

# ì‚¬ìš© ì˜ˆì‹œ
def demonstrate_security_approval():
    """ë³´ì•ˆ ìŠ¹ì¸ ì‹œìŠ¤í…œ ë°ëª¨"""
    st.header("ğŸ” Security Operation Approval System")
    
    approval_ui = SecurityApprovalUI()
    approval_ui.show_security_settings()
    
    # ë°ëª¨ ì‘ì—…ë“¤
    demo_operations = {
        "Network Scan": {
            "risk": RiskLevel.LOW,
            "target": "192.168.1.100",
            "details": {
                "scan_type": "TCP SYN Scan",
                "port_range": "1-1000",
                "timeout": "30 seconds"
            },
            "warnings": []
        },
        "Vulnerability Assessment": {
            "risk": RiskLevel.MEDIUM,
            "target": "example.com",
            "details": {
                "scan_type": "CVE Database Check",
                "depth": "Standard",
                "tools": ["Nmap", "OpenVAS"]
            },
            "warnings": ["May trigger intrusion detection systems"]
        },
        "Exploit Attempt": {
            "risk": RiskLevel.HIGH,
            "target": "test-server.local",
            "details": {
                "exploit": "CVE-2024-1234",
                "payload": "Reverse Shell",
                "method": "Buffer Overflow"
            },
            "warnings": [
                "Will attempt to gain unauthorized access",
                "May crash target service",
                "Requires explicit written authorization"
            ]
        }
    }
    
    # ì‘ì—… ì„ íƒ
    selected_operation = st.selectbox(
        "Select Operation to Approve:",
        list(demo_operations.keys())
    )
    
    if st.button(f"Request Approval for {selected_operation}"):
        op_data = demo_operations[selected_operation]
        
        # ìë™ ìŠ¹ì¸ ê²€ì‚¬ (LOW ìœ„í—˜ë„ë§Œ)
        if (op_data["risk"] == RiskLevel.LOW and 
            st.session_state.get("auto_approve_low", False)):
            st.success("âœ… Operation auto-approved (LOW risk)")
        else:
            # ìŠ¹ì¸ ë‹¤ì´ì–¼ë¡œê·¸ í‘œì‹œ
            approved = approval_ui.show_approval_dialog(
                operation=selected_operation,
                target=op_data["target"],
                risk_level=op_data["risk"],
                details=op_data["details"],
                warnings=op_data["warnings"]
            )
            
            if approved:
                st.balloons()
]]></correct-example>
<incorrect-example title="ìë™ ì‹¤í–‰" conditions="ìœ„í—˜í•œ ë³´ì•ˆ ì‘ì—… ì‹¤í–‰" expected-result="ëª…ì‹œì  ì‚¬ìš©ì ìŠ¹ì¸" incorrectness-criteria="ì‚¬ìš©ì ìŠ¹ì¸ ì—†ëŠ” ìë™ ì‹¤í–‰"><![CDATA[
def auto_execute_operation(operation: str, target: str):
    """ìë™ ì‹¤í–‰ (ìœ„í—˜)"""
    # ì‚¬ìš©ì ìŠ¹ì¸ì´ë‚˜ ìœ„í—˜ë„ í‰ê°€ ì—†ì´ ë°”ë¡œ ì‹¤í–‰
    if st.button(f"Execute {operation}"):
        execute_security_operation(operation, target)
        st.success("Operation completed")
]]></incorrect-example>
</example>
</examples>
</non-negotiable>
</requirements>

<context description="CLI ë° ì›¹ ì¸í„°í˜ì´ìŠ¤ ì»¨í…ìŠ¤íŠ¸">
Decepticonì˜ ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ëŠ” ë³´ì•ˆ ì „ë¬¸ê°€ë“¤ì´ ë³µì¡í•œ AI ê¸°ë°˜ ë ˆë“œíŒ€ í…ŒìŠ¤íŒ…ì„ íš¨ìœ¨ì ìœ¼ë¡œ ìˆ˜í–‰í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì•¼ í•©ë‹ˆë‹¤.
CLIëŠ” ìë™í™”ì™€ ìŠ¤í¬ë¦½íŒ…ì— ì í•©í•˜ê³ , ì›¹ ì¸í„°í˜ì´ìŠ¤ëŠ” ëŒ€í™”í˜• ì‘ì—…ê³¼ ì‹œê°ì  ë¶„ì„ì— ìµœì í™”ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.
ë³´ì•ˆ ì‘ì—…ì˜ íŠ¹ì„±ìƒ ì‚¬ìš©ìì˜ ëª…ì‹œì  ìŠ¹ì¸ê³¼ ì¶©ë¶„í•œ ì •ë³´ ì œê³µì´ í•„ìˆ˜ì ì…ë‹ˆë‹¤.
</context>

<references>
<reference as="dependency" href=".cursor/rules/main-project-rules.mdc" reason="ê¸°ë³¸ í”„ë¡œì íŠ¸ ê·œì¹™">ë©”ì¸ í”„ë¡œì íŠ¸ ê·œì¹™</reference>
<reference as="context" href=".cursor/rules/security-pentesting.mdc" reason="ë³´ì•ˆ ì‘ì—… ìŠ¹ì¸">ë³´ì•ˆ ë° íœí…ŒìŠ¤íŒ… ê·œì¹™</reference>
<reference as="context" href=".cursor/rules/error-handling.mdc" reason="UI ì—ëŸ¬ ì²˜ë¦¬">ì—ëŸ¬ ì²˜ë¦¬ ë° ì˜ˆì™¸ ê´€ë¦¬</reference>
</references>
</rule>
